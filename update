#!/system/bin/sh

# Enable KSM to reduce memory usage
echo 1 > /sys/kernel/mm/ksm/run

# Enable zRAM for improved memory management
echo lz4 > /sys/block/zram0/comp_algorithm
echo 1073741824 > /sys/block/zram0/disksize # 1GB of swap space
echo 1 > /sys/block/zram0/reset
mkswap /dev/block/zram0
swapon /dev/block/zram0

# Adjust scheduler settings for improved CPU performance
echo deadline > /sys/block/mmcblk0/queue/scheduler
echo 2048 > /sys/block/mmcblk0/queue/nr_requests
echo 4096 > /sys/block/mmcblk0/queue/read_ahead_kb
echo 0 > /sys/block/mmcblk0/queue/iosched/fifo_batch
echo 0 > /sys/block/mmcblk0/queue/iosched/writes_starved

# Apply kernel tweaks for improved performance
echo 1 > /proc/sys/kernel/sched_migration_cost_ns
echo 0 > /proc/sys/kernel/sched_autogroup_enabled
echo 1 > /proc/sys/kernel/sched_cstate_aware
echo 0 > /proc/sys/kernel/sched_boost
echo 1 > /proc/sys/kernel/sched_prefer_sync_wakee_to_waker
echo 500000 > /proc/sys/kernel/sched_latency_ns
echo 100000 > /proc/sys/kernel/sched_min_granularity_ns
echo 500000 > /proc/sys/kernel/sched_wakeup_granularity_ns

# Set governor for maximum CPU performance
echo performance > /sys/devices/system/cpu/cpufreq/policy0/scaling_governor

# Set GPU governor for maximum performance
echo performance > /sys/class/kgsl/kgsl-3d0/devfreq/governor

# Disable unnecessary services for improved performance
stop thermal-engine
stop thermal-engine-2801
stop thermal-engine-3100

# Disable animations for maximum performance
settings put global window_animation_scale 0.0
settings put global transition_animation_scale 0.0
settings put global animator_duration_scale 0.0

# Enable high-performance mode for screen
echo 1 > /sys/class/graphics/fb0/hpd_mode

# Optimize internet connectivity for maximum performance
echo 3 > /proc/sys/net/ipv4/tcp_syn_retries
echo 1 > /proc/sys/net/ipv4/tcp_tw_reuse
echo 1 > /proc/sys/net/ipv4/tcp_tw_recycle
echo 1048576 > /proc/sys/net/core/wmem_max
echo 1048576 > /proc/sys/net/core/rmem_max
echo 1048576 > /proc/sys/net/ipv4/tcp_wmem
echo 1048576 > /proc/sys/net/ipv4/tcp_rmem

# Create swap space using RAM
echo 0 > /proc/sys/vm/swappiness
dd if=/dev/zero of=/swapfile bs=1M count=2048
mkswap /swapfile
swapon /swapfile
